<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Andy Grogan-Kaylor" />
  <title>Logistic Regression</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="../UMslidy.css" />
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Logistic Regression</h1>
  <p class="author">
Andy Grogan-Kaylor
  </p>
</div>
<div class="slide section level1">

<p>Andy Grogan-Kaylor</p>
<p>23 May 2020</p>
</div>
<div id="key-concepts-and-commands" class="slide section level1">
<h1>Key Concepts and Commands</h1>
<ul class="incremental">
<li>Fitting a Curve to 2 Possible Values</li>
</ul>
<p><img src="logistic.png" /></p>
<ul class="incremental">
<li><p>Linear models, probit and logit</p></li>
<li><p><code>y x1 x2 ...</code> <span class="math inline">\(\leftarrow\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(F(y) = \beta_0 + \beta x_1 + \beta x_2 ...\)</span></p></li>
<li><p><code>regress y x1 x2</code> OLS; Linear Model</p></li>
<li><p><code>logit y x1 x2</code> Logistic Regression</p></li>
<li><p><code>probit y x1 x2</code> Probit Regression</p></li>
<li><p><code>glm ...</code></p></li>
</ul>
</div>
<div id="limited-dependent-variables" class="slide section level1">
<h1>Limited Dependent Variables</h1>
<ul class="incremental">
<li>Categorical Dependent Variable</li>
<li>Binary Dependent Variable</li>
<li>Limited Dependent Variable</li>
</ul>
</div>
<div id="general-social-survey" class="slide section level1">
<h1>General Social Survey</h1>
<pre class="stata"><code>. use &quot;/Users/agrogan/Box Sync/DATA WAREHOUSE/General Social Survey Panel Data/GSS_panel
&gt; 2010w123_R6 - stata.dta&quot;, clear 
( )</code></pre>
<pre class="stata"><code>. codebook happy_3 // what does this variable look like?

────────────────────────────────────────────────────────────────────────────────────────
happy_3                                                       happy_3: GENERAL HAPPINESS
────────────────────────────────────────────────────────────────────────────────────────

                  type:  numeric (byte)
                 label:  HAPPY_3

                 range:  [1,3]                        units:  1
         unique values:  3                        missing .:  0/2,044
       unique mv codes:  3                       missing .*:  742/2,044

            tabulation:  Freq.   Numeric  Label
                           391         1  VERY HAPPY
                           758         2  PRETTY HAPPY
                           153         3  NOT TOO HAPPY
                             1        .d  DK
                           740        .i  IAP
                             1        .n  NA</code></pre>
</div>
<div id="data-management" class="slide section level1">
<h1>Data Management</h1>
<pre class="stata"><code>. recode happy_3 (1/2 = 1)(3=0), generate(happy_3_D)
(911 differences between happy_3 and happy_3_D)</code></pre>
<pre class="stata"><code>. tabulate happy_3 happy_3_D // double check

              │   RECODE of happy_3
     happy_3: │   (happy_3: GENERAL
      GENERAL │      HAPPINESS)
    HAPPINESS │         0          1 │     Total
──────────────┼──────────────────────┼──────────
   VERY HAPPY │         0        391 │       391 
 PRETTY HAPPY │         0        758 │       758 
NOT TOO HAPPY │       153          0 │       153 
──────────────┼──────────────────────┼──────────
        Total │       153      1,149 │     1,302 </code></pre>
<pre class="stata"><code>. keep happy_3 happy_3_D coninc_3 // keep only some variables</code></pre>
<pre class="stata"><code>. save GSSsmall.dta, replace
file GSSsmall.dta saved</code></pre>
</div>
<div id="visualize" class="slide section level1">
<h1>Visualize</h1>
<pre class="stata"><code>. twoway scatter happy_3_D coninc_3, scheme(burd) jitter(5)</code></pre>
<pre class="stata"><code>. graph export happiness-income.png, width(500) replace
(file happiness-income.png written in PNG format)</code></pre>
<div class="figure">
<img src="happiness-income.png" alt="Happiness and Income" />
<p class="caption">Happiness and Income</p>
</div>
</div>
<div id="linear-probability-model" class="slide section level1">
<h1>Linear Probability Model</h1>
<pre class="stata"><code>. regress happy_3_D coninc_3

      Source │       SS           df       MS      Number of obs   =     1,223
─────────────┼──────────────────────────────────   F(1, 1221)      =     22.87
       Model │  2.26477708         1  2.26477708   Prob &gt; F        =    0.0000
    Residual │  120.937185     1,221  .099047654   R-squared       =    0.0184
─────────────┼──────────────────────────────────   Adj R-squared   =    0.0176
       Total │  123.201962     1,222  .100819936   Root MSE        =    .31472

─────────────┬────────────────────────────────────────────────────────────────
   happy_3_D │      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
    coninc_3 │   9.69e-07   2.03e-07     4.78   0.000     5.72e-07    1.37e-06
       _cons │   .8368664   .0137133    61.03   0.000     .8099621    .8637706
─────────────┴────────────────────────────────────────────────────────────────</code></pre>
</div>
<div id="normal-and-cumulative-normal-distribution" class="slide section level1">
<h1>Normal and Cumulative Normal Distribution</h1>
<pre class="stata"><code>. clear all</code></pre>
<pre class="stata"><code>. set obs 100 // 100 observations
number of observations (_N) was 0, now 100</code></pre>
<pre class="stata"><code>. generate z = runiform(-5, 5) // randomly distributed z scores</code></pre>
<pre class="stata"><code>. generate mynormaldensities = normalden(z) // normal densities</code></pre>
<pre class="stata"><code>. generate myprobabilities = normal(z) // cumulative normal probabilities</code></pre>
<pre class="stata"><code>. twoway scatter mynormaldensities myprobabilities z, scheme(michigan)</code></pre>
<pre class="stata"><code>. graph export normal.png, width(500) replace
(file normal.png written in PNG format)</code></pre>
<div class="figure">
<img src="normal.png" alt="Standard and Cumulative Normal Curves" />
<p class="caption">Standard and Cumulative Normal Curves</p>
</div>
</div>
<div id="the-probit-model" class="slide section level1">
<h1>The Probit Model</h1>
<pre class="stata"><code>. use GSSsmall.dta, clear
( )</code></pre>
<pre class="stata"><code>. probit happy_3_D coninc_3

Iteration 0:   log likelihood = -433.05123  
Iteration 1:   log likelihood = -419.92819  
Iteration 2:   log likelihood = -419.73499  
Iteration 3:   log likelihood = -419.73484  
Iteration 4:   log likelihood = -419.73484  

Probit regression                               Number of obs     =      1,223
                                                LR chi2(1)        =      26.63
                                                Prob &gt; chi2       =     0.0000
Log likelihood = -419.73484                     Pseudo R2         =     0.0308

─────────────┬────────────────────────────────────────────────────────────────
   happy_3_D │      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
    coninc_3 │   6.43e-06   1.35e-06     4.76   0.000     3.78e-06    9.08e-06
       _cons │   .9244086   .0721521    12.81   0.000     .7829931    1.065824
─────────────┴────────────────────────────────────────────────────────────────</code></pre>
</div>
<div id="the-logistic-distribution" class="slide section level1">
<h1>The Logistic Distribution</h1>
<pre class="stata"><code>. clear all</code></pre>
<pre class="stata"><code>. set obs 100 // 100 observations
number of observations (_N) was 0, now 100</code></pre>
<pre class="stata"><code>. generate z = runiform(-5, 5) // randomly distributed z scores</code></pre>
<pre class="stata"><code>. generate mylogisticdensities = logisticden(z) // logistic densities</code></pre>
<pre class="stata"><code>. generate mylogisticprobabilities = logistic(z) // cumulative logistic probabilities</code></pre>
<pre class="stata"><code>. twoway scatter mylogisticdensities mylogisticprobabilities z, scheme(michigan)</code></pre>
<pre class="stata"><code>. graph export logistic.png, width(500) replace
(file logistic.png written in PNG format)</code></pre>
<div class="figure">
<img src="logistic.png" alt="Standard and Cumulative Logistic Curves" />
<p class="caption">Standard and Cumulative Logistic Curves</p>
</div>
</div>
<div id="the-logit-logistic-model" class="slide section level1">
<h1>The Logit (Logistic) Model</h1>
<pre class="stata"><code>. use GSSsmall.dta, clear
( )</code></pre>
<pre class="stata"><code>. logit happy_3_D coninc_3

Iteration 0:   log likelihood = -433.05123  
Iteration 1:   log likelihood = -420.07608  
Iteration 2:   log likelihood = -419.28644  
Iteration 3:   log likelihood = -419.28513  
Iteration 4:   log likelihood = -419.28513  

Logistic regression                             Number of obs     =      1,223
                                                LR chi2(1)        =      27.53
                                                Prob &gt; chi2       =     0.0000
Log likelihood = -419.28513                     Pseudo R2         =     0.0318

─────────────┬────────────────────────────────────────────────────────────────
   happy_3_D │      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
    coninc_3 │   .0000134   2.93e-06     4.58   0.000     7.68e-06    .0000192
       _cons │   1.484066   .1381599    10.74   0.000     1.213277    1.754854
─────────────┴────────────────────────────────────────────────────────────────</code></pre>
</div>
<div id="comparison-of-lpm-probit-and-logistic-coefficients" class="slide section level1">
<h1>Comparison of LPM, Probit and Logistic Coefficients</h1>
<p>NB: Negative vs. positive <span class="math inline">\(\beta\)</span>.</p>
<pre class="stata"><code>. quietly probit happy_3_D coninc_3</code></pre>
<pre class="stata"><code>. est store myprobit</code></pre>
<pre class="stata"><code>. quietly logit happy_3_D coninc_3</code></pre>
<pre class="stata"><code>. est store mylogit</code></pre>
<pre class="stata"><code>. est table myprobit mylogit

─────────────┬──────────────────────────
    Variable │  myprobit     mylogit    
─────────────┼──────────────────────────
    coninc_3 │  6.430e-06    .00001343  
       _cons │  .92440857    1.4840659  
─────────────┴──────────────────────────</code></pre>
</div>
<div id="logistic-model-2" class="slide section level1">
<h1>Logistic Model (2)</h1>
<blockquote>
<p>Derivation of logistic model from linear probability model. Using instructor notes</p>
</blockquote>
<p><span class="math display">\[ \ln \left( \frac{P(y)}{1-P(y)} \right) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... \]</span></p>
</div>
<div id="interpretation-of-odds-ratios-robert-mare" class="slide section level1">
<h1>Interpretation of Odds Ratios (Robert Mare)</h1>
<p><span class="math display">\[ 0 &lt; OR &lt; 1 \]</span></p>
<blockquote>
<p>indicates that an increase in x is associated with a decrease in y.</p>
</blockquote>
<p><span class="math display">\[ 1 &lt; OR &lt; \infty \]</span></p>
<blockquote>
<p>indicates that an increase in x is associated with an increase in y.</p>
</blockquote>
</div>
<div id="a-poem-about-logistic-regression" class="slide section level1">
<h1>A Poem About Logistic Regression</h1>
</div>
<div id="complete-determination" class="slide section level1">
<h1>Complete Determination</h1>
<p>See handout</p>
</div>
<div id="rare-events" class="slide section level1">
<h1>Rare Events</h1>
<ul class="incremental">
<li>Statistical power</li>
<li>Complete determination</li>
</ul>
</div>
<div id="predicted-probabilities" class="slide section level1">
<h1>Predicted Probabilities</h1>
<p>Discussion</p>
</div>
<div id="the-general-linear-model" class="slide section level1">
<h1>The General Linear Model</h1>
</div>
<div id="interaction-terms" class="slide section level1">
<h1>Interaction Terms</h1>
<p>See interactive demo, or example script.</p>
<p>https://agrogan1.github.io/multilevel/logistic-interactions/logistic-interactions.html</p>
</div>
</body>
</html>
