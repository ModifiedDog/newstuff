---
title: "Bayes Theorem"
subtitle: "Applied To Data Analysis"
author: "Andy Grogan-Kaylor"
institute: "University of Michigan"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{css, echo=FALSE}

@import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');
.title-slide { 
  color: #ffcb05;
  background-color: #00274C; 
}
.title-slide h1 {
    color: #ffcb05;
}
pre {
  white-space: pre-wrap;
}
h1, h2, h3 {
  font-family: 'Montserrat', sans-serif;
}
body { 
    font-family: 'Montserrat', sans-serif;
}
.author, .date {
  font-family: 'Montserrat', sans-serif;
}

```

# Bayes Theorem Applied To Data Analysis

--

|               | D=1                  | D=0                             |
|:--------------|:---------------------|:--------------------------------|
| H=1           | $P(D, H)$            | $P(\text{not} D, H)$            |
| H=0           | $P(D, \text{not} H)$ | $P(\text{not} D, \text{not} H)$ |

--

From the definition of conditional probability: 

--

$P(D|H) = P(D,H) / P(H)$

--

$P(H|D) = P(D,H) / P(D)$

---
# Then: 

--

$P(D|H)P(H) = P(D,H)$

--

$P(H|D)P(D) = P(D,H)$

--

# Then:

$P(D|H)P(H) = P(H|D)P(D)$

--
Then:

$P(D|H) = \frac{P(H|D)P(D)}{P(H)}$ Bayes Theorem

--

$\text{posterior} \sim \text{likelihood} \times \text{prior}$

---
# Example 

Consider an example using 1,000 hypothetical studies. We imagine that only 10% of interventions are likely to have results. We adopt standard assumptions of adopting an $\alpha$, or chance of detecting an effect when one is not there of 5%. We similarly assume 80% power $\beta$, or a 20% chance of failing to detect an effect when it is not present. 

--

|                          | D=1 (effect)        | D=0 (non effect)   |
|:-------------------------|:--------------------|:-------------------|
| Data (D)                 | 100 effects         | 900 non-effects    |
| H=1 (conclude effect)    | 80 true positives   | 45 false positives |
| H=0 (conclude no effect) | 20 false negatives  | 855 true negatives |

* With thanks to the [Wikipedia article](https://en.wikipedia.org/wiki/Bayes%27_theorem#Cancer_rate) on this topic for inspiration for this example.

---
# Calculations

--

$$P(\text{effect} | \text{conclude effect}) = \frac{P(\text{conclude effect} | \text{effect}) P(\text{effect})}{P(\text{conclude effect})}$$

--

$$P(\text{effect} | \text{conclude effect}) = \frac{.8 \times .1}{.125} = .64$$
> See also [Thinking Through Bayesian Ideas](https://agrogan.shinyapps.io/Thinking-Through-Bayes/)




